---

- name: Include OS family specific vars
  include_vars: "{{ ansible_os_family }}.yml"

- name: Install Docker CE
  include_tasks: "install-{{ ansible_os_family }}.yml"

- name: Start docker
  service:
    name: docker
    state: started
    enabled: true

- name: get docker info
  docker_host_info:
  register: dockerinfo

- name: show all
  debug:
    var: dockerinfo.host_info

- name: show driver
  debug:
    var: dockerinfo.host_info.Driver

- name: show driver
  debug:
    var: dockerinfo.host_info.DriverStatus.['Backing Filesystem']
  when: dockerinfo.host_info.DriverStatus is defined and dockerinfo.host_info.DriverStatus.['Backing Filesystem'] is defined

- name: Set storage driver when required
  include_tasks: config-driver.yml
